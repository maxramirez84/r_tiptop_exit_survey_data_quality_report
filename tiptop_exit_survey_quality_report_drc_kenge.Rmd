---
output: 
  html_document: 
    css: style.css
---
```{r parameters, include=FALSE}
source("tiptop_exit_survey_quality.R")
source("lang.R")
source("tokens.R")

# Report language
kReportLang <- "FR"
language <- kLang[[kReportLang]]

# Data retrieval: {api, file}
data.retrieval.mode <- "api"

# API
api.url   <- kREDCapAPIURL
api.token <- kAPITokenDRC # TIPTOP Cost-Effectiveness Exit Survey DRC

# File
file.prefix  <- "DATA/DATA_WITH_NO_DUPS/XXX"
file.content <- "_DATA_WITH_NO_DUPS_"
file.date    <- "2018-06-19"
file.time    <- "15:42"

# Varibles in dataset to be excluded and therefore not extracted
non.retrieved.variables <- c()

# Partner information
partner.name <- "BEGIS"
partner.url  <- "http://www.begis-congo.net"

# Study area description
country           <- "RDC"
study.area.id     <- 1
study.area.label  <- "Kenge"
study.area.column <- "kenge"
sample.size       <- 142
hf.to.be.surveyed <- 8

report.title <- paste(language$head.survey, '-', language$head.report, ':', country, '-', study.area.label)
data.timestamp <- DataTimestamp(data.retrieval.mode, file.date, file.time)
```
---
title: "`r report.title`"
author: "Máximo Ramírez Robles"
date: "`r data.timestamp`"
---

```{r out.width="30px", echo=FALSE}
knitr::include_graphics("github_icon.png")
```
[`r language$head.github`](https://github.com/maxramirez84/r_tiptop_exit_survey_data_quality_report)

```{r setup, include=FALSE}
# Retrieve Exit Survey data, filter it by study area and remove empty records
data <- ReadData(data.retrieval.mode, file.prefix, file.content, file.date, 
                 file.time, api.url, api.token, non.retrieved.variables)
data <- data[data$district == study.area.id, ]
data <- data[!is.na(data$record_id), ]

last.record.date <- LastRecordDate(data)
number.of.records <- NumberOfRecords(data)
```

## `r language$progress.title`

`r sprintf(language$progress.records, number.of.records)` 
(`r sprintf(language$progress.last, last.record.date)`).

`r language$progress.partner` [`r partner.name`](`r partner.url`).

```{r recruited.women.area, echo=FALSE}
consented <- NumberOfParticipantsWhoConsented(data)
recruitment <- RecruitmentRate(data, sample.size)
```

### `r language$progress.subtitle1`

<div class="col-left text-center">
  `r language$progress.women` @ `r study.area.label`

  <span class="big-number">`r recruitment`%</span>

  `r consented` / `r sample.size`
</div>
